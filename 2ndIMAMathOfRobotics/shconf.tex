\documentclass{svproc}
\usepackage{geometry} % see geometry.pdf on how to lay out the page. There's lots.
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{gensymb}
\usepackage[affil-it]{authblk}
\usepackage[toc,page]{appendix}
\usepackage{pifont}
\usepackage{bm}
\usepackage{relsize}
%% \usepackage{draftwatermark}
\usepackage[mathscr]{eucal}
\usepackage{amsmath, amssymb, graphics, setspace}
%% \usepackage{amsart}
%% \usepackage{amsthm}
\usepackage[english]{babel}
\usepackage{listings}
\lstloadlanguages{Mathematica}
\usepackage{mathtools}
\usepackage{subcaption}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}



\newcommand{\mathsym}[1]{{}}
\newcommand{\unicode}[1]{{}}

%% \newtheorem{exercise}{Exercise}
%% \newtheorem{theorem}{Theorem}
%% \newtheorem{corollary}{Corollary}
%% \newtheorem{lemma}{Lemma}
%% \newtheorem{conjecture}{Conjecture}
\newtheorem{observation}{Observation}

\newenvironment{sketch}{%
  \renewcommand{\proofname}{Proof Sketch}\proof}{\endproof}

\DeclareMathOperator{\atantwo}{atan2}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\sense}{sense}

% \geometry{letter} % or letter or a5paper or ... etc
% \geometry{landscape} % rotated page geometry

% See the ``Article customise'' template for come common customisations

%%% BEGIN DOCUMENT
\begin{document}

\author{Robert L. Read\inst{1}}

\titlerunning{Calculating the Segmented Helix}
\title{Calculating the Segmented Helix Formed by Repetitions of Identical Subunits}

\institute{Public Invention, Austin, TX 78704, USA,\\
\email{read.robert@gmail.com},\\ WWW home page:
\texttt{https://www.pubinv.org}
}
\date{\today}


\maketitle

\abstract{
Eric Lord has observed:
\begin{quote}
  In nature, helical structures arise when identical structural subunits combine sequentially, the orientational and translational relation between each unit
  and its predecessor remaining constant.\cite{lord2002helical}
\end{quote}
If a robot is composed of modular structural subunits that can change their shape or relation, the shape of the robot
can change. If they all change in the same way, the robot will be a segmented helix of varying length and curvature.
Closed-form expressions are given for the parameters of
the segmented helix generated from the intrinsic properties of a chained object and its
conjoining rule.
The construction of these from the intrinsic properties of the rule for conjoining repeated subunits of arbitrary shape is provided,
allowing the complete parameters describing the unique
segmented helix generated by arbitrary stackings to be easily calculated.
Free-libre open-source interactive software and a website is provided which performs this computation
for arbitrary prisms along with interactive 3D visualization\cite{segmentedhelixinteractive}.
This allows the deduction of intrinsic properties of a repeated subunit from known properties of a segmented helix, as a chemist might
want to do.
Because the algorithms are efficient, a repeated subunit can be designed to create a segmented helix of
desired properties,
as a mechanical engineer or roboticist might want.
A theorem, proved in a longer version \cite{readfullsegmentedhelix}, is stated that any chain
can be transformed continuous between a toroid-like helix and a maximally-extended helix
by varying joint-face normal twist.
}

\keywords{Helix, Variable Geometry Truss, Segmented Helix, Solid Geometry, Screw Theory, Platonic Helix}


\makeatletter
\newcommand{\subjclass}[1]{%
    \small
    \textbf{Mathematics Subject Classification:} #1}


\makeatother

\subjclass{ 97G40, 52B12}

\section{Introduction}

The participants of the Public Invention Mathathon of 2018\cite{read2019mathathon} noticed:
\begin{observation}[Lord's Observation]
  “In nature, helical structures arise when identical structural subunits combine sequentially, the orientational and translational relation between each unit and its predecessor remaining constant.”\cite{lord2002helical}
  \label{obs:lords}
\end{observation}
Having found no earlier articulation of this statement
in writing, it is justified to name it after its earliest known author.

The purpose of this paper is to provide mathematical
tools and software for studying arbitrary
structures generated in this way, which are modeled as segmented helices.
A proof of Lord's Observation is provided in a longer version\cite{readfullsegmentedhelix}.
An interactive, 3D rendering website written in JavaScript which allows both calculation and
interactive play and study is provided\cite{segmentedhelixinteractive}
(see Figure \ref{fig:dodecahedron}).

Lord's Observation is exploited to discover symmetry which allows us to compute the helix when subunits are joined face-to-face with
the same {\em twist.}
This concept can be generalized to a {\em joint face angle}, even if the
objects conjoined do not technically have flat faces.
Varying the {\em twist} of the joint faces through a complete rotation produces a smoothly varying
spectrum of shapes that always includes a torus-like shape and a
{\em zig-zag} planar segmented helix of maximal extent.
A robot thus constructed of identical modules which can change their shape, such as the TetRobot of Figure \ref{fig:tetrahelices}, allows the helix to coil and uncoil
predictably based on the math herein.

\begin{figure}
  \centering

  \subcaptionbox{Tetrahelix\label{fig:helixnodes}}
{\includegraphics[width=0.48\textwidth]{figures/UnifiedDrawing.png}}
\subcaptionbox{The 7-tet Public Invention Tetrobot\label{fig:tetrobot}}
{\includegraphics[width=0.48\textwidth]{figures/MedCantedCropped.png}}
\caption{Tetrahelix Robots}\label{fig:tetrahelices}
\end{figure}

\begin{figure}
     \centering
     \includegraphics[width=0.30\textwidth]{figures/Dodecahedral.png}
     \caption{Screenshot: Example Segmented Helix Generated From the Dodecahedron}
  \label{fig:dodecahedron}
\end{figure}

\section{The Segmented Helix}

The goal is to mathematically descibe a chain of physical objects by
calculating
the parameters for a continuous helix conincient on the joints by studying
a helix evaluated at integral points. Call such an object a {\em segmented helix}.
A segmented helix may be thought of as function that, given an integer, gives back a point in
3-space:
\begin{align}
    P_x(n) &= r \sin{n \theta}  \\
    P_y(n) &= r \cos{n \theta} \\
   P_z(n) &= n d
\end{align}

There are two complementary ways of learning about such segmented helices.
In one approach (see {\em PointAxis} of Section \ref{sec:pointaxis})
we have knowledge of the segmented helix and
wish to learn about the subunits and the rule with which the subunits are combined.
In the other approach ({\em The Joint Face Normal Method} of Section \ref{sec:facenormal}),
one may know {\it a priori} exactly the
relevant properties of the objects and the rule with which they combine
and seek to compactly describe the segmented helix they create.


\begin{figure}
     \centering
     \includegraphics[width=0.30\textwidth]{figures/ABCDFigure.png}
     \caption{Naming of measures}
  \label{fig:naming}
\end{figure}

Figure \ref{fig:naming}, a screenshot, demonstrates naming convention concepts.
An arbitrary repeated object is represented as a simplifying prism
with triangular cross-section,  that supports a face-to-face connection.

In this canonical representation the helix axis is
the $z$-axis.
$\theta$ is the rotation around the $z$-axis
between adjacent points, and
$r$ is the radius of the segmented helix.

In this diagram, the
points $A,B,C$, and $D$ are represented by the sphere of the same color as the label. The view is roughly in the direction of
the axis of the segmented helix, which is drawn as a dark green arrow, pointing in the positive $z$ and positive $x$ direction,
parallel to the $XZ$-plane.

Any point on the segmented helix has a closest point on the axis of the helix.
In particular, the points closest to the
joints are called {\em joint axis points}, $B_a$ and $C_a$.
Then $d$ is the distance along the axis (travel) between consecutive joint axis points.

A segmented helix located in space is completely determined by
the three intrinsic parameters $r,d,\theta$, plus
a vector describing the axis
of the helix, and the position of any one joint.

The following concepts and conventional variable names for them will be related:
\begin{itemize}
\item $L$ is the distance between any two adjacent joints (between $B$ and $C$, for example).
  \item $c$ is the length of a chord formed by the projection of the segment between two points projected along the axis of the segmented helix (a chemist may recognize this as the distance between residues on a {\em helical wheel} projection).
\item $\phi$ is the angle between any vector between two adjacent joints and the axis of the helix. In physical screws used in mechanical engineering, this is analogous to the {\em helix angle}.
  \end{itemize}
Finally, we find it useful to define the {\em tightness t} of a segmented helix
as travel divided by radius, a number
analogous to the extension of a coil spring or slinky.
A torus-like segmented helix has zero tightness and a zig-zag has
maximum tightness.

These quantities are related:
\begin{align}
    c &= 2r\sin{\frac{\theta}{2}} \\
    L^2 &= c^2+d^2  \\
    \arctan{\frac{c}{d}}  &= \phi \\
    t &= d / r
\end{align}

\label{sec:SegmentedHelix}

\section{Periodic Chains Produce Segmented Helices}

Identical objects conjoined via a rule
produce {\em periodic chains} of objects that are uniformly intersected
by segmented helices.


\begin{theorem}[Segmented Helix]
  \label{thm:helix}
  Consider $N$ identical objects which each have two points, $A$ and $B$, called {\em joints}. Call
  $\overrightarrow{AB}$ the {\em axis} of this object.
  Consider the frame of reference for this object to have
  its axis on the $z$-axis with $B$ in the positive direction, the
  midpoint of the object being at the origin.

  Consider any rule that conjoins $A$ of object $i+1$ to $B$ such that
  from the frame of reference of $i$, the object $i+1$ and anything rigidly
  attached to it is always in the same position in the frame of reference for $i$.
  Informally, $i+1$ ``looks the same'' to $i$, no matter what $i$ is chosen, $i < N$.
  Call a chain of $N$ identical rigid objects conjoined via a rule that
  conjoins $A_{i+1}$ to $B_i$ in such a way that every vector
  of $B$ is always in the same position relative to a frame of reference
  constructed from $A$, a {\em periodic chain.}

  Any periodic chain of three or more objects has a unique segmented helix
  whose segments
  lies on the axes of these objects.
\end{theorem}

A proof is provided in the longer version of this paper\cite{readfullsegmentedhelix}.
Because periodic chains are merely a clarification of the ``identical structural subunits''
of Observation \ref{obs:lords},
this theorem proves Lord's observation.

Note that Theorem \ref{thm:helix} is independent of the actual
shape or shapes of the objects joined, so long as the rule for joining them
is universal.

Because a helix may be degenerate, Theorem \ref{thm:helix} clarifies that
a periodic chain of objects may also be degenerate to the human eye, in that they may:
\begin{enumerate}
\item form a straight line,
\item be planar about a center, forming a polygon or ring, or
\item form a planar saw-tooth or zig-zag pattern of indefinite extent ($\theta = \pi$).
\end{enumerate}

\section{{\em PointAxis}: Computing Segmented Helices from Joints}
\label{sec:pointaxis}

Using tools from linear algebra \cite{kahn1989defining}, a sketch of finding the segmented helix from
four consecutive known points $A,B,C$, and $D$, is:
\begin{itemize}
\item Construct a rigid transformation that places the points conveniently on the $z$-axis and balanced
  around the $y$-axis.
\item Compute the bisectors of the angle between object axes $ \angle{ABC}$, called $\overrightarrow{B_b}$ and the
  bisecting angle $\overrightarrow{C_b}$ of $\angle{BCD}$.
  If the points are collinear, they are a special case.
\item Because these angle bisectors point at the axis of the segmented helix, their cross product is a vector
  in the direction of the axis. If $\overrightarrow{B_b}$ and $\overrightarrow{C_b}$ are parallel or anti-parallel the cross product is not defined, requiring a modified calculation.
\item  Otherwise the vectors $\overrightarrow{B_b}$ and $\overrightarrow{C_b}$ are skew, and the algorithm for the closest points on
  two skew lines provides two axis points $B_a$ and $C_a$ on these vectors which
  are the closest points on those lines and are also points on the helix axis.
\item The distance between $B_a$ and $B$ is the radius, and the distance between $B_a$ and $C_a$ is the travel $d$ along the axis.
  \item The angle between $\overrightarrow{B - B_a}$ and $\overrightarrow{C - C_a}$ is $\theta$.
\end{itemize}

In order to use the {\em PointAxis} algorithm, we need a way
to compute points $A$ and $D$ in balance around the axis $BC$. In the full paper\cite{readfullsegmentedhelix}
we state and sketch a proof of a lemma that the points $A$ and $D$ can always be brought into simplifyiing balance.

From the observations that $\| \overrightarrow{B - B_a} \| = \| \overrightarrow{C - C_a} \|$
it becomes clear that the helix axis is in a plane
parallel to the $XZ$-plane, it intersects the $y$-axis, but in general is
not parallel to the $z$-axis.

Because the angle bisectors of each joint are in general skew, and intersect the
axis perpendicularly, the algorithm
for the closest points on two skew lines finds $B_a$ and $B_c$.

A careful arrangement of the axes
allows the computation of $\phi$, the angle between the helical axis
and the $z$ axis. This, in combination with symmetry and the knowledge
that the helical axis is in the $XZ$ plane, supports computing the
points on the axis corresponding to the joints directly from $\phi$.

Define the angle bisector vectors:
\begin{align}
  \overrightarrow{B_b} &= B - (A + C)/2 \\
  \overrightarrow{C_b} &= C - (B + D)/2
  \end{align}
The fundamental insight that the axis of the helix $H$ can be
computed by a cross product of the angle bisector
vectors ($\overrightarrow{B_b}$ and $\overrightarrow{C_b}$) applies only
when the angle-bisectors have a non-zero length and when
they are not parallel or anti-parallel.
The math for both of these special cases is provided in the longer paper\cite{readfullsegmentedhelix}.

The signed travel along the axis $d$ is
the scalar projection of a segment $\overrightarrow{C - B}$ onto $\overrightarrow{H}$.
From this $\phi$ is directly calculable. $\phi$ allows
a direct calculation of the $x,y$ and $z$ components of the
point $B_a$ on the axis pointed to by $\overrightarrow{B_b}$.
$r$ is the distance between $B_a$ and $B$. Quantities $c$ and $\theta$
are easily computed from these values.

\begin{align}
  \overrightarrow{H} &=  \begin{bmatrix} -2 B_{b[y]} B_{b[z]} \\ 0 \\ 2 B_{b[y]} B_{b[x]}  \end{bmatrix} \\
  d &= \frac{L B_{b[x]}}{\sqrt{B_{b[x]}^2 + B_{b[z]}^2}}  \\
  \phi &= \atantwo{(H_z,H_x)} - \pi/2  \\
  c &= \sqrt{L^2 - d^2}
\end{align}

In this approach to calculation, it is easiest
to compute the axis point $B_a$ corresponding to $B$ and
use it to complete our computations.
From trigonometry and utilizing the facts that $\phi = \arccos{(d/L)}$  and $\sin{(\arccos{x})} = \sqrt{1 - x^2}$ it
can be shown that
the $x$ and $z$ component of $B_a$ are:
\begin{align}
  B_{a[x]} &= \frac{d\sqrt{1 - (d/L)^2}}{2} \\
  B_{a[z]} &= -\frac{d^2}{2L}
\end{align}

However, this computation exposes another special case: when the
helix angle $\phi$ is $\pi /2$, the segmented helix is
torus-like. In this case the axis point $B_a$ is in fact
on the $y$-axis, and so only $B_{a[y]}$ is need:
\begin{align}
  B_{a[y]} &=  \frac{L B_{b[y]}}{2 B_{b[z]}}
\end{align}
Except for in the toroidal case,  $B_{b[x]}$ must be taken into
account, but it is non-zero, so we can divide by it.
By imagining a plane pressed downward from the
object axis to the helix axis, it is apparent that $B_{a[y]}$
is proportional to a ratio of the angle bisector
$B_{b[y]}/B_{b[x]}$ times the $B_{a[x]}$ value:
\begin{align}
  B_{a[y]} &=  \frac{ B_{b[y]} B_{a[x]}}{ B_{b[x]}}
\end{align}

Having computed all of $B_a$, the remaining intrinsic properties are easily
calculated:

\begin{align}
  r &= \norm{B - B_a}  \\
  \theta &= 2 \arcsin{\frac{c}{2r}}
\end{align}

Finding the properties of a segmented helix from three contiguous segments on the helix from screw theory\cite{wittenburg2016kinematics,kahn1989defining},
is roughly equivalent, but seems to preclude deriving closed-form expressions as simple as these.


\section{The Joint Face Normal Method}
\label{sec:facenormal}

{\em PointAxis} takes a point $A$ known to be in a specific, balanced relation
to $B, C$ and $D$. A chemist might know four such points from crystallography
and be able to move them into this symmetric position along the $z$-axis.
However, one might instead know something of the subunits and
how they are conjoined, without actually knowing where points $A$
and $D$ are.

Take as given these intrinsic properties of an object, and additionally the
rule for how objects are laid face-to-face. That is, knowing the length between two
joint points and a vector normal to the faces of the two joints, we almost have
enough to determine the unique stacking of objects. The final piece
needed is
the {\em twist}. When face $A$ of a second object is placed on face $B$
of a first object so that they are flush (that is, their face normals are in opposite directions),
it remains the case that the second object can be rotated about the normals. To
define the joining rule, attach an {\em up(out) vector} to each object that points away from the axis.
Then a joining
rule is ``place the second object against the first, joint point coincident to joint point,
and twist it so that its out vector differs by $\tau$ degrees from the out vector of the first
object.'' In this definition, the out vectors are considered to be measured against the plane
containing the two axes meeting in a joint.

If the objects are macroscopic objects which have faces, this is the same as the rotation
of the axis of the second object relative to the first in the plane of the coincident faces.
Define intrinsic properties:

\begin{itemize}
\item Given an object with two identified faces, labeled $B$ and $C$, assume there are normalized
  vectors $\overrightarrow{N_B}$ and $\overrightarrow{N_C}$
  from each of these points that are aligned with the axis of the conjoined object attached to
  that face.
\item The length $L$ of an object, measured from joint point $A$ to joint point $B$.
\item A joint twist $\tau$ defining the change in computed out-vector between objects,
  measured at the joint face.
\end{itemize}
Then the points $A$ and $D$ can be computed and {\em PointAxis} used to calculate the
segmented helix.

\section{Changing $\tau$ Smoothly Changes Tightness}

Upon implementing our interactive ability to vary $\tau$, the following
theorem becomes visually apparent.

\begin{theorem}[Twist Spectrum]
  For any choice of non-parallel face normals having non-zero $x$ or $y$ components,
  changing the twist angle $\tau$ through a complete rotation ($0 \leq \tau \leq 2\pi$)
  smoothly varies the segmented helix
  between a torus and flat cases.
\end{theorem}

A proof is provided in the full version of this paper\cite{readfullsegmentedhelix}.
The Twist Spectrum theorem asserts that if the twist between the modules of a robot
can be varied consistently, then the robot can easily move through a toroid-like shape
into a linear shape and back, as illustrated in Figure \ref{fig:coiling}. If it does not self-collide, it can even change the chirality
or handedness of the helix it forms.

In the calculator page
the $\tau$ that produces the minimum tightness (torus-like) and maximum tightness (zig-zag) to the
nearest 360-degree is numerically calculated.

\begin{figure}
  \centering

  \subcaptionbox{$\tau = -3.75 \degree$ }
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau-375.png}}
\subcaptionbox{$\tau = 0 \degree$}
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau0.png}}
\subcaptionbox{$\tau = 3.75 \degree$}
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau375.png}}
  \subcaptionbox{$\tau = 7.5 \degree$ }
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau75.png}}
  \subcaptionbox{$\tau = 15 \degree$ }
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau15.png}}
\subcaptionbox{$\tau = 30 \degree$}
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau30.png}}
\subcaptionbox{$\tau = 60 \degree$}
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau60.png}}
\subcaptionbox{$\tau = 120 \degree$}
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau120.png}}
\subcaptionbox{$\tau = 180 \degree$}
{\includegraphics[width=0.32\textwidth]{figures/coiling/tau180.png}}
\caption{Coiling via change to $\tau$}\label{fig:coiling}
\end{figure}

\section{Confirmations and Related Research}

The {\em tetrobot}\cite{TetrobotBook} is the concept of completely
modular robot built entirely out of tetrahedra whose side lengths can
be varied under electronic control. Such robots tend to be inherently
tensegrities\cite{NTRT}, although where the cable lengths
have shrunk to zero.
The current work was instigated by the author's research with a seven-tet tetrobot
displayed in Figure
\ref{fig:tetrobot}.
In particular, it is possible to construct a tentacle, snake-like or
variable-geometry truss configuration of tetrahedra which, in its relaxed
mode, is a regular tetrahelix.

The math in the paper applies to modules of any shape---tetrahedra being
merely an important instance.
The Boerdijk-Coxeter tetrahelix (BC helix) (see Figure \ref{fig:helixnodes}) is a periodic chain of conjoined regular tetrahedra
which has been much studied\cite{coxeter1985simplicial,sadler2019periodic,fuller1982synergetics,read2018transforming}
and happens to have irrational measures, making it an ideal
test case for these algorithms/formulae. A recent paper\cite{sadler2019periodic} has explored this
and given an explicit formula for a {\em twist} exactly as defined in this
paper in order to produce a periodic tetrahelix. Both specific instances match the more general results of {\em PointAxis}.

Periodic chains of the five regular Platonic solids joined face-to-face so that their vertices coincide,
which form {\em Platonic helices}\cite{elgersma2016quadrahelix,lord2001sphere}, are completely calculated in a table\cite{readfullsegmentedhelix}.
It is discovered that there 28 unique members of this ``zoo'' of structures which are occasionally found in chemistry\cite{lord2004gamma,pearce1990structure}



\bibliographystyle{unsrt}
\bibliography{shelix}

\appendix


\end{document}
